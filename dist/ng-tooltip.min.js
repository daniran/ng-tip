/*
 * ng-tooltip
 * a simple replacement for AngularUI tooltip
 * Danny Rankevich <danny.ran@gmail.com>

 * Version: 0.1.0 - 2015-08-18
 * License: MIT
 */
angular.module("ng.tooltip",["ng.tooltip.tmpl"]),angular.module("ng.tooltip").factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!=a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,d,e){var f,g,h,i,j=c.split("-"),k=j[0],l=j[1]||"center";f=e?this.offset(a):this.position(a),g=b.prop("offsetWidth"),h=b.prop("offsetHeight");var m={center:function(){return f.left+f.width/2-g/2},left:function(){return f.left},right:function(){return f.left+f.width}},n={center:function(){return f.top+f.height/2-h/2},top:function(){return f.top},bottom:function(){return f.top+f.height}};switch(k){case"right":i={top:n[l](),left:m[k]()+d};break;case"left":i={top:n[l](),left:f.left-g-d};break;case"bottom":i={top:n[k]()+d,left:m[l]()};break;default:i={top:f.top-h-d,left:m[l]()}}return i}}}]),angular.module("ng.tooltip").directive("ngTooltip",["$position","$controller","$compile","$document","$timeout",function(a,b,c,d,e){return{scope:{ngTooltipConfig:"=",ngTooltip:"="},link:function(f,g,h){function i(a){var b=angular.element(a.target),c=b.closest(l[0]);c.length||e(function(){k()})}function j(){var c=o?f.$new(!0):f.$parent,e={$scope:c,$tooltipInstance:{config:m,close:function(){k()}}};b(m.controller,e);l=q(c,function(a,b){n?d.find("body").append(a):g.after(a)}),d.find("body")[0].addEventListener("click",i,!0);var h=l.find(".ng-tooltip-element");h.css({height:m.height,width:m.width});var j=a.positionElements(g,h,m.placement||"bottom",20,n);h.css(j)}function k(){d.find("body")[0].removeEventListener("click",i,!0),f.ngTooltip=!1,l&&(l.remove(),l=null)}var l,m=f.ngTooltipConfig,n=angular.isDefined(m.appendToBody)?m.appendToBody:!1,o=angular.isDefined(m.isolateScope)?m.isolateScope:!0,p="<ng-tooltip-content><ng-include src=\"'"+m.templateUrl+"'\"></ng-include></ng-tooltip-content>",q=c(p);f.$watch("ngTooltip",function(a,b){a?j():k()})}}}]),angular.module("ng.tooltip").directive("ngTooltipContent",function(){return{transclude:!0,templateUrl:"ng-tooltip-template.html"}}),angular.module("ng.tooltip.tmpl",["ng-tooltip-template.html"]),angular.module("ng-tooltip-template.html",[]).run(["$templateCache",function(a){a.put("ng-tooltip-template.html",'<div class="ng-tooltip-element">\n    <div class="ng-tooltip-arrow"></div>\n    <div class="ng-tooltip-content">\n        <ng-transclude></ng-transclude>\n    </div>\n</div>\n')}]);